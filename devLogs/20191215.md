# 烹饪机制
## 菜品组合
菜品组合即制作菜品时所使用的主料、配料、烹饪方式的集合。
菜品组合的结算与菜谱的最终结算整合。
## 特殊组合
在游戏文件内拥有一个特殊组合的表格。譬如“葱+姜”、“蛋+煎”、“西瓜+辣椒”、“胡萝卜+炒+糖”。
当“当前菜品组合”出现了某项特殊组合，便会触发“特殊组合”的效果。
特殊组合会带来一定的buff，并且会影响最后的计分。  
Buff包括：
* 味觉参数加成
* 味觉系数加成
* 过程参数加成
* 过程系数加成
* 总分加成

# 烹饪方式
烹饪方式需要具有的参数有：
进入最小需油量、进入最大需油量、退出最小需油量、进入最小需水量、进入最大需水量、退出最小需水量、最大火力、最小火力；油蒸发函数、水蒸发函数、熟度计算函数、入味度计算函数、加热均匀度计算函数。

不同的烹饪方式会提供不同的加水加油区间、过程参数变化函数、油水蒸发速率以及玩家参与游戏的方式。

当玩家进入加热工作台时，可以选择下一步进行的动作。
譬如玩家进入SF_Table，按下打火按键时，系统会提示玩家选择煎、炒、炸、焖其中之一烹饪方式加热食物。选定后，玩家需要在这个模式下特定区间内选择加水量和加油量以及初始火力。从玩家选择烹饪方式到玩家再一次选择烹饪方式的这一过程被视为一个完整的加热流程。
游戏中有以下烹饪方式：
	煎（只能在炒锅进行）
	炸（只能在炒锅进行）
	炒（只能在炒锅进行）
	焖（只能在炒锅进行。）
	煮（只能在煮锅进行）
	炖（只能在煮锅进行）
## 煎
在煎模式下，玩家点击左键造成的影响是将锅里的材料翻面。（x轴反转180°）
随着煎的进行，朝下半面的材质将会改变。（需要在建模时分好UV）
过程参数特殊计算方式
以翻面作为分段标志，将参数分为0、1两个分区进行计算。对于单个主料Gameobject，加热指数为0、1两区加热指数之和；
## 炒
在炒模式下，玩家点击左键造成的影响如demo。
随着炒的进行，总体材质将会改变。
## 炸
在炸模式下，玩家点击左键造成的影响如demo。
材料将悬浮于油面。
随着炸的进行，总体材质将会改变。

## 焖
在焖模式下，锅盖将会盖上。玩家无法控制锅铲。
随着焖的进行，总体材质将会改变。

## 煮
在煮模式下，锅盖将会盖上。
## 炖
在炖模式下，锅盖将会盖上。
如果煮锅在进行炖且玩家进入煮锅区，时间流速会加快，也就是说在现实世界同样的时间内，炖模式可以增加更多的加热点数。退出煮锅区，时间流速不变。
## 关于油与水
每一种烹饪方式都有进入最小需油/水量和进入最大需油/水量。只有当锅里的油与水处于这一区间内，才能进行这一烹饪方式。  
在玩家选择烹饪方式后，系统会提示玩家需要加入油/水量的区间，玩家只能在这一区间内选择添加量。  
随着烹饪的进行，油与水会蒸发，当油与水低于退出最小需油/水量时，会强制进行烹饪方式选择。  
当某种烹饪方式的最大需油/水量小于当前锅内油/水量时，这个烹饪方式是不可选的。如：若玩家正在进行炒的操作，此时锅内的含水量较大，超过了炸的进入最大需水量，则此时若玩家选择改变烹饪方式，界面中的炸是不可选的。需要等待锅内水蒸发完毕。  
水与油的蒸发还与火力有关。
## 关于火力
玩家在进入一种烹饪方式时会被要求在最大火力与最小火力之间选择一个初始火力开始烹调。在烹调的过程中，玩家可以随时改变火力，但是火力必须处于最小最大火力区间内。

# 过程参数
每一种食材会拥有不同的参数变化系数。
不同的烹饪方式可能会有不同的计算方式，这里给出的是一般的计算方式。
## 熟度
衡量食物加热程度的量。与加热时间、加热时的火力大小、烹饪方式有关。
计算公式为
$$p=\frac {\sum \left( h_{i}\times w_{i}\right) }{\sum w_{i}}$$
$h_{i}$为加热指数，$w_{i}$为权重
## 入味度
衡量食物的入味程度。与切菜方式（切丁、切块、切条）、烹饪方式、加热时间、火力有关。
计算公式为
$$p=\frac {\sum \left( s_{i}\times w_{i}\right) }{\sum w_{i}}$$
其中$s_{i}$为入味指数，$w_{i}$为权重
加热均匀度
衡量食物的被加热的均匀水平。与切菜方式、翻炒次数、加热方式、烹饪方式有关。
区间为[0,100]
计算公式为  
$$p=100-\sigma _{n}$$  


$\sigma _{n}$ 表示加热指数的标准差。  


$$\sigma_{n}=\sqrt{\frac{\sum d_{i}}{\sum w_{i}}}$$       


 $d _{i}$ 表示单个食材与加热均值的离散程度，如果该食材加热方式为煎，则


$$d_{i}=W_{i}\left( \frac {h_{a}-h_{b}}{2}\right) ^{2}$$

如果为其他方式，则

$$d_{i}=w_{i}\left( h_{i}-\overline {h}\right) ^{2}$$

$h_{a}$, $h_{b}$为被煎食材正反两面的加热指数， $\overline {h}$应为上述参数中的熟度
## 关于显示量
熟度的显示量为当前熟度。
入味度的显示量为当前入味度
加热均匀度的显示量为当前加热均匀度
## 关于核算量
熟度的核算量为最终熟度。
入味度的核算量最终入味度。
加热均匀度的核算量为最终加热均匀度
## 材料对参数的影响关系
主料会影响所有参数的计算。即公式中的“食材系数”。  
配料会以一定的公式关系影响参数。譬如盐的属性是【入味度+2* 使用量】，则入味度计算时，会额外加上（2* 加盐量）。也可能是其他一些函数关系。
一般会引用到的量有：
计算配料前该参数的量
* 配料使用量
* 加热时间
* 加热火力
* 烹饪方式
* 切菜方式
* 翻炒次数
# 味觉参数
味道参数是衡量食物酸、甜、辣、咸、鲜的量。
## 计算方式
计算公式为：
$$p_{一种材料的一种味觉系数}=a_{自身系数}\times k_{烹饪方式系数}\left( \frac {1}{1+e^{-b_{自身系数}\times n_{使用量}}}-0.5\right)$$
最终核算的味觉参数是各种材料在各阶段的味觉参数之和。
 
